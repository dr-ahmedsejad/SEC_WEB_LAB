import hashlib

# 1. Les variables
cle_secrete = "ELBARAKA_SECRET"
donnee_originale = '{"prix": 25000}'
donnee_piratee = '{"prix": 1}'


def calculer_signature(donnee, cle):
    # C'est ici que la magie op√®re : CONCAT√âNATION
    # On colle la donn√©e et la cl√© ensemble
    melange = donnee + cle

    # On hache le m√©lange
    signature = hashlib.sha256(melange.encode()).hexdigest()
    return signature


# --- SC√âNARIO ---

# 1. Le Serveur cr√©e le cookie l√©gitime
sig_legitime = calculer_signature(donnee_originale, cle_secrete)
print(f"‚úÖ Signature pour 25000 : {sig_legitime}")
print(f"   (Bas√©e sur le m√©lange cach√© : '{donnee_originale}{cle_secrete}')")

print("-" * 30)

# 2. Mirade attaque (Il change le prix, mais il garde l'ancienne signature)
print(f"üè¥‚Äç‚ò†Ô∏è Mirade envoie : Donn√©e='{donnee_piratee}' avec Signature='{sig_legitime}'")

# 3. Le Serveur v√©rifie
# Le serveur recalcule la signature pour la donn√©e re√ßue (prix: 1) AVEC SA CL√â
sig_verification = calculer_signature(donnee_piratee, cle_secrete)
print(f"üõ°Ô∏è Le serveur calcule pour 'prix: 1' : {sig_verification}")

# 4. Verdict
if sig_legitime == sig_verification:
    print("FATAL ERROR: Le serveur a accept√© le prix de 1 MRU !")
else:
    print("SUCC√àS : Le serveur rejette le cookie car les signatures ne matchent pas.")